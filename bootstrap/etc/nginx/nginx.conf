user www-data;
pid  /var/run/nginx.pid;
 
worker_processes auto;
 
events {
    worker_connections  4096;
}
  
http {
    # NGINX Settings
    # ==============
    sendfile    on;
    tcp_nopush  on;
    tcp_nodelay on;
    keepalive_timeout 3;
  
    include /etc/nginx/mime.types;
    default_type application/octet-stream;
  
    # WORDPRESS CLUSTER
    # =================
    server {
        listen 80 default;
 
        root /srv/carbon/src;
        index index.php;
        server_name carbon.test;
 
        client_max_body_size 8m;
  
        # LOGGING
        # =======
        access_log /var/log/nginx/access.log combined;
        error_log  /var/log/nginx/error.log;
 
       	location / {
           try_files $uri $uri/ /index.php$uri?$args;
        }
 
        location ~ [^/]\.php(/|$) {
            fastcgi_split_path_info ^(.+?\.php)(\/.*)$;

			set $path_info $fastcgi_path_info;
			fastcgi_param PATH_INFO $path_info;


            fastcgi_index index.php;
            fastcgi_pass unix:/run/php/php7.2-fpm.sock;
            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
            fastcgi_param HTTP_PROXY "";
            include fastcgi_params;
        }
 
        # Prevent access to restricted files.
        location ~ /\.ht {
            deny all;
        }
    }
}